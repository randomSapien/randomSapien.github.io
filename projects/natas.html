<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="../stylesheets/style.css">
	<title>Natas Walkthrough</title>

</head>
<body>
<br><br>
<a class="button bkbtn" href="../projects.html"> Back </a> 
<h3>OVER THE WIRE- NATAS <a href="https://overthewire.org/wargames/natas/" > <img src="../images/link.svg"> </a></h3> 
		<p>Just as they say on their webpage, Natas teaches the basics of serverside web-security.
		This CTF is for beginners who are looking to sharpen their skills in web security.<br>Each level has the password for the next level and all the passwords are also stored in /etc/natas_webpass directory. 
		Hints will be provided in this walkthrough to give a chance for your wheels to spin.  
		Try your best to solve each level on your own before looking at the solution. Goodluck!!! </p><br>

<h3 class="heading"> Natas 0 <a href="http://natas0.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata0 <br> Password : natas0 </p>
		<img src="images/natas 0.png" height="auto" width="60%">
		<button class="accordion">Hint </button>
		<div class="panel">
		<p>Every page has souce code. Find out how to view it.</p>
		</div>

		<button class="accordion">Solution</button>
		<div class="panel">
		<p>Right-click on the page and select View Page Source.</p>
		<img src="images/natas0b.png" width="60%" height="auto" > 
		<br><br><p>Password : gtVrDuiDfck831PqWsLEZy5gyDz1clto  </p>
		</div>


<h3 class="heading"> Natas 1 <a href="http://natas1.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata1 <br></p>
		<img src="images/natas1.png" width="60%" height="auto">
		<button class="accordion">Hint </button>
		<div class="panel">
		 <p>There are other ways to view page source. Find out how.</p>
		</div>

		<button class="accordion">Solution 1</button>
		<div class="panel">
		 <p>You can either search type this in the address bar 
		view-source:http://natas1.natas.labs.overthewire.org/  
		</div>

		<button class="accordion">Solution 2</button>
		<div class="panel">
		 <p>Use Ctrl+U as a keyboard shortcut for the same.
		 <br> Password : ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi</p>
		</div>

<h3 class="heading"> Natas 2 <a href="http://natas2.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata2 <br></p>
		<img src="images/natas2.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>An image is displayed in the html page from a directory called files.</p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>Try to view all the contents of the files directory. Try editing the url.</p>
		</div>

		<button class="accordion">Solution </button>
		<div class="panel">
		<p>Search for http://natas2.natas.labs.overthewire.org/files and all the contents of the files directory is displayed. Now, all that we have to do is to select the users.txt and find the password. </p>
		<img src="images/natas2b.png" width="60%" height="auto"><br><br>
		Password : sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14 
		</div>

<h3 class="heading"> Natas 3 <a href="http://natas2.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata3 <br></p>
		<img src="images/natas3.png" width="60%" height="auto">
		<p>Page Source </p>
		<img src="images/natas3b.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>You are looking for a .txt file and its related to how search engines index web pages. </p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>Crawlers wont index this file.</p>
		</div>

		<button class="accordion">Solution </button>
		<div class="panel">
		<p>You have to navigate to the robots.txt file. <br>
				Search http://natas3.natas.labs.overthewire.org/robots.txt<br><br>
				<b>Robots.txt</b> <br>
					User-agent: *<br>
					Disallow: /s3cr3t/<br><br>
					Which means every user-agen (aka browser in our case) is not allowed to index /s3cr3t.<br> 
					So we got to search for /s3cr3t. <br>
					Search http://natas3.natas.labs.overthewire.org/s3cr3t. Here you will find user.txt which contains the password. <br>
					Password : Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ</p>
	
		</div>		


		<h3 class="heading"> Natas 4 <a href="http://natas4.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
<p> Username : nata4 <br></p>
		<img src="images/natas4.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>This one is pretty obvious. You have to visit the page as if you are from natas5. Burpsuite is a tool that can help you here.  </p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>Intercept the traffic and add a request header</p>
		</div>

		<button class="accordion">Solution </button>
		<div class="panel">
		<p>
				  Intercept the traffic using burpsuite proxy and add Referer header in the request.<br>			  
				  The referer should be "http://natas5.natas.labs.overthewire.org/"."<br><br>
				  <img src="images/natas4c.png" width="60%" height="auto"><br>
				  <img src="images/natas4b.png" width="60%" height="auto"><br><br>
					Password : iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq </p>
		</div>	



<h3 class="heading"> Natas 5 <a href="http://natas5.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata5 <br></p>
		<img src="images/natas5.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>The request is the key. Burpsuite is a tool that can help you here.  </p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>Pay attention to the values in the request.</p>
		</div>

		<button class="accordion">Solution </button>
		<div class="panel">
		<p>
				  Intercept the traffic using burpsuite proxy.<br>Change the value of  loggedin value in the request from 0 to 1.<br><br>
				  <img src="images/natas5b.png" width="60%" height="auto"><br>
				  <img src="images/natas5c.png" width="60%" height="auto"><br><br>
					Password : aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1 </p>
		</div>			


<h3 class="heading"> Natas 6 <a href="http://natas6.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata6 <br></p>
		<img src="images/natas6.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>The source code has something really interesting for us.</p>
		<img src="images/natas6b.png" width="60%" height="auto">
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>You are looking for a file.</p>
		</div>

		<button class="accordion">Solution </button>
		<div class="panel">
		<p>
				  The secret is stored in the includes/secret.inc file.<br>
				  Navigate to http://natas6.natas.labs.overthewire.org/includes/secret.inc and view its source.
				  <br><br><img src="images/natas6c.png" width="60%" height="auto"><br><br>
				  It has the secret stored in it.Use this to find the password to the next level.
				  <br><br><img src="images/natas6d.png" width="60%" height="auto"><br><br>
					Password : 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9  </p>
		</div>		

<h3 class="heading"> Natas 7 <a href="http://natas7.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata7 <br></p>
		<img src="images/natas7.png" width="60%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>Notice the url while accessing the home and about pages.</p>
		<img src="images/natas7c.png" width="60%" height="auto">
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>Directory Traversal. In the page source, they give us a hint saying that the password is stored in /etc/natas_webpass/natas8.</p>
		</div>

		<button class="accordion">Solution</button>
		<div class="panel">
		<p>You have to traverse to the /etc/natas_webpass/natas8 page using<br> 
				<p class="code">http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8
				</p><br><br>
				  <img src="images/natas7c.png" width="60%" height="auto"><br><br>
				  Password : DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe </p>

		</div>		



<h3 class="heading"> Natas 8 <a href="http://natas8.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata8 <br></p>
		<img src="images/natas8a.png" width="60%" height="auto">
		<p>Page Source </p>
		<img src="images/natas8.png" width="80%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>The secret is encoded multiple times and hardcoded into the source. You will have to decode it to get the password.</p>
		</div>

		<button class="accordion">Solution</button>
		<div class="panel">
		<p>You can decode the secret using php -a command (-a : Interactive mode )<br> 
				</p><br><br>
				  <img src="images/natas8b.png" width="60%" height="auto"><br><br>
				  <img src="images/natas8c.png" width="60%" height="auto"><br><br>
				  Password : W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl </p>

		</div>




<h3 class="heading"> Natas 9 <a href="http://natas9.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata9 <br></p>
		<img src="images/natas9b.png" width="60%" height="auto">
		<p>Page Source </p>
		<img src="images/natas9a.png" width="80%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>The user input is directly executed and output is passed to the webpage. </p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>You just need to input a command that prints the password of natas 10 from /etc/natas_webpapass_natas10. </p>
		</div>

		<button class="accordion">Solution</button>
		<div class="panel">
		<p>You can view the natas 10 password using the command <br>
		<p class="code"> grep '' /etc/natas_webpass/natas10;</p> 
				</p>
				Since grep is already a part of the command, we just need to input the rest of the command. <br><br>
				<p class="code">  '' /etc/natas_webpass/natas10;</p> 
				  <img src="images/natas9c.png" width="60%" height="auto"><br><br>
				  Password : nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu </p>
		</div>



		<h3 class="heading"> Natas 10 <a href="http://natas10.natas.labs.overthewire.org" > <img src="../images/link.svg"> </a></h3>
		<p> Username : nata10 <br></p>
		<img src="images/natas10a.png" width="60%" height="auto">
		<p>Page Source </p>
		<img src="images/natas10b.png" width="80%" height="auto">
		<button class="accordion">Hint 1 </button>
		<div class="panel">
		<p>The user input is filtered and executed and output is passed to the webpage. </p>
		</div>

		<button class="accordion">Hint 2 </button>
		<div class="panel">
		<p>You just need to input a command that prints the password of natas 11 from /etc/natas_webpapass_natas11. The command to be executed is similar to the previous level. </p>
		</div>

		<button class="accordion">Solution</button>
		<div class="panel">
		<p>You can view the natas 10 password using the command <br>
		<p class="code"> grep '' /etc/natas_webpass/natas11 %3b </p> 
				</p>
				%3b is just url encoded ';'. Since grep is already a part of the command, we just need to input the rest of the command. <br><br>
				<p class="code">  '' /etc/natas_webpass/natas11 %3b</p> 
				  <img src="images/natas10c.png" width="60%" height="auto"><br><br>
				  Password : U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK </p>
		</div>






<script>
var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.display === "block") {
      panel.style.display = "none";
    } else {
      panel.style.display = "block";
    }
  });
}
</script>
<br><br><br>
</body>
</html>
